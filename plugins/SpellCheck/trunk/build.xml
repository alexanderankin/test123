<?xml version="1.0"?>
<!-- :tabSize=4:indentSize=4:noTabs=false: -->

<!-- This is a build.xml file for building the SpellCheck plugin.     -->
<!--                                                                  -->
<!-- The 'dist' target compiles the plugin, creates the documentation -->
<!--      and the SpellCheck.jar file.                                -->
<!-- Note that this build file uses ../build-support,                 -->
<!-- available from jedit source repository                           -->

<project name="SpellCheck" default="dist" basedir=".">

	<property name="user-doc.xml" location= "users-guide.xml"/>
	<property name="src.dir" value="src"/>
	<property name="src.test.dir" value="src/test"/>

	<!-- my only Test Case -->
	
	<!-- for build-support location -->
	<property file="../build.properties"/>
	<!-- build support -->
	<import file="${build.support}/plugin-build.xml" />

    <property name="build.tests"  value="${build.dir}/tests" />

	<!-- can switch-off compilation of test-cases -->
	<selector id="compileFiles">
		<or>
        <filename name="main/**/*.java" />
        <filename name="test/**/*.java" />
		</or>		
    </selector>

	<selector id="junit.testcases">
        <filename name="cswilly/**/FutureAspellTest.java" />
    </selector>

	<!-- for junit tests -->
	<property name="unit.test.target" value="test-junit"/>
    <!-- {{{ Target: test-junit============================ -->
    <!-- Executes a jUnit test case defined by the plugin's
         build file. The classpath for the test will be the
         ${build.class} directory, the ${junit.jar} file and
         the default.class.path and project.class.path path
         structures.
         -->
    <target name="test-junit"
            description="Runs the plugin's jUnit tests.">
        <echo message="Running tests..."/>
        <mkdir dir="${build.tests}"/>
        <junit printsummary="${junit.printsummary}"
                haltonfailure="${junit.haltonfailure}" showoutput="${junit.showoutput}">

            <classpath>
                <pathelement location="${junit.jar}" />
                <pathelement location="${build.classes}" />
                <path refid="default.class.path" />
                <path refid="project.class.path" />
            </classpath>

            <batchtest todir="${build.tests}">
                <fileset dir="${src.test.dir}">
                  <selector refid="junit.testcases"/>
                </fileset>
           </batchtest>
           <formatter type="brief"/>
        </junit>

    </target>
    <!-- ===============================================}}} -->
	

	<target name="build.prepare"
		depends="compile"
		description="Remove Unit-Tests from the build classes">
		<echo message="Removing test classes.."/>
		<delete dir="${build.classes}">
			<and>
			<filename name="**/*Test*.class"/>
			<not><filename name="cswilly/spell/Test.class"/></not>
			</and>
		</delete>
	</target>
</project>

