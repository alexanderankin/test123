==================================================
Packaging jEdit for release
==================================================

This document contains instructions on how to create and release jEdit for distribution, with all of the installers.

The analogous document for releasing plugins is in the jedit SVN repository under the name "pjo/doc/pjo.txt".

Release Workflow
================
Before you read this document, be sure to read first the README.SRC.txt, in the root source directory. It contains instructions on how to get and set up Apache Ant, what the targets mean, and what you need to build each kind of package.

Workflow
--------

1. Update your sourcecode to the latest version by doing
        svn update
   in jEdits source directory

2. Check in all your local changes by doing
        svn commit -m "put your commit message here"
   in jEdits source directory

3. Do
        svn status -u
   in jEdits source directory to be sure you are in sync with the SVN repository

4. Tag the sourcecode for release in the SVN repository by doing
        svn copy https://jedit.svn.sourceforge.net/svnroot/jedit/jEdit/branches/4.3.x https://jedit.svn.sourceforge.net/svnroot/jedit/jEdit/tags/jedit-4-3-3 -m "Tagging 4.4 for release."
   with the correct version in the second URL and in the commit message

5. To be sure to work with the exact tagged source, check out the newly tagged source in a new directory by doing
        svn checkout https://jedit.svn.sourceforge.net/svnroot/jedit/jEdit/tags/jedit-4-3-3
   no matter where. You will find the source in a subfolder jedit-4-3-3 where you executed the command

6. Copy build.properties and jars/build.properties from your jEdit source directory to the newly created jedit-4-3-3 source directory. If you don't have the two, then create them. For the root directory you find a template called build.properties.sample there and for the jars/build.properties you find a template in build-support/build.properties. These are independent and have to be set up correctly. The one in the root directory is for jEdit itself, the one in jars is for the standard plugins.
   To give an example, in build.properties I customized the following properties:
    - innosetup.compiler.executable=C:\\Programme\\Inno Setup 5\\ISCC.exe
    - xsltproc.executable=C:\\Programme\\xsltproc\\xsltproc.exe
    - docbook.xsl=C:\\Programme\\DocBook\\XSL\\1.70.1\\
    - docbook.catalog=C:\\Programme\\DocBook\\XML\\4.2\\docbook.cat
    - fop.dir=C:\\Programme\\FOP
   And in jars/build.properties I customized the following properties:
    - install.dir=${jedit.install.dir}/jars
    - jedit.plugins.dir=${install.dir}
    - jedit.jars.dir=${install.dir}
    - docbook.catalog=C:\\Programme\\DocBook\\XML\\4.2\\docbook.cat
    - docbook.xsl=C:\\Programme\\DocBook\\XSL\\1.70.1\\
    - xsltproc.executable=C:\\Programme\\xsltproc\\xsltproc.exe
   You may not need to customize the same properties than me, e. g. if xsltproc is in your PATH environment variable, you may not need to customize xsltproc.executable.
   For further information about what you need to build the source, please read README.SRC.txt in the sources root directory.

7.1. Build the distribution files by doing
          ant dist
     in the jedit-4-3-3 directory
     In the newly created directory jedit-4-3-3/dist you find 8 files:
      - jedit4.4manual-a4.pdf
      - jedit4.4manual-letter.pdf
      - jedit4.4source.tar.bz2
      - jedit4.4install.jar
      - jedit-4.4-noarch-1sao.tgz
      - jedit_4.4_all.deb
      - jedit4.4install.exe or jedit4.4-dist-win-finish.tar.bz2
      - jedit4.4install.dmg or jedit4.4-dist-mac-finish.tar.bz2

7.2. If you have jedit4.4-dist-win-finish.tar.bz2 in your jedit-4-3-3/dist folder you probably don't run a Windows box, so please hand over this file to someone (e. g. <Björn "Vampire" Kautler> Vampire@jEdit.org) who does and ask him to unpack the file and run
          ant dist-win-finish
     and to hand over the resulting file jedit4.4install.exe to you. The requirements for this are described in README.SRC.txt

7.3. If you have jedit4.4-dist-mac-finish.tar.bz2 in your jedit-4-3-3/dist folder you probably don't run a Mac OS X box, so please hand over this file to someone (e. g. Björn "Vampire" Kautler <Vampire@jEdit.org>) who does and ask him to unpack the file and run
          ant dist-mac-finish
     and to hand over the resulting file jedit4.4install.dmg to you. The requirements for this are described in README.SRC.txt

7.4. After you received the final distribution files jedit4.4install.exe and jedit4.4install.dmg you can delete jedit4.4-dist-win-finish.tar.bz2 and jedit4.4-dist-mac-finish.tar.bz2

8. - Connect to the SourceForge servers via one of the methods described in https://sourceforge.net/apps/trac/sourceforge/wiki/Release%20files%20for%20download
   - Add the sub-folder "4.4" under "/home/frs/project/j/je/jedit/jedit"
   - Upload the 8 final distribution files to the newly created folder on the SourceForge servers
   - Upload the jedit-4-3-3/doc/CHANGES.txt file to the newly created folder on the SourceForge servers

9. - Go to https://sourceforge.net/project/admin/explorer.php?group_id=588
   - Navigate to the folder you created in the last step
   - Make the following settings for each file
        - CHANGES.txt
            - Name: CHANGES.txt
            - Label: Change Log
            - Release Note: checked
        - 4.4
            - Name: 4.4
            - Label: jEdit 4.4
            - Release notes for this folder: /jedit/4.4/CHANGES.txt
        - jedit_4.4_all.deb
            - Name: jedit_4.4_all.deb
            - Label: Debian Installer
            - Release note: unchecked
            - Release notes for this file: /jedit/4.4/CHANGES.txt
            - Platform: <none>
        - jedit4.4source.tar.bz2
            - Name: jedit4.4source.tar.bz2
            - Label: Source Package
            - Release note: unchecked
            - Release notes for this file: /jedit/4.4/CHANGES.txt
            - Platform: <none>
        - jedit4.4install.jar
            - Name: jedit4.4install.jar
            - Label: Java based Installer
            - Release note: unchecked
            - Release notes for this file: /jedit/4.4/CHANGES.txt
            - Platform: linux, bsd, solaris, others
        - jedit4.4manual-letter.pdf
            - Name: jedit4.4manual-letter.pdf
            - Label: Manual in Letter Paper size
            - Release note: unchecked
            - Release notes for this file: /jedit/4.4/CHANGES.txt
            - Platform: <none>
        - jedit4.4manual-a4.pdf
            - Name: jedit4.4manual-a4.pdf
            - Label: Manual in A4 Paper size
            - Release note: unchecked
            - Release notes for this file: /jedit/4.4/CHANGES.txt
            - Platform: <none>
        - jedit4.4install.dmg
            - Name: jedit4.4install.dmg
            - Label: Mac OS X Installer
            - Release note: unchecked
            - Release notes for this file: /jedit/4.4/CHANGES.txt
            - Platform: mac
        - jedit4.4install.exe
            - Name: jedit4.4install.exe
            - Label: Windows Installer
            - Release note: unchecked
            - Release notes for this file: /jedit/4.4/CHANGES.txt
            - Platform: windows
        - jedit-4.4-noarch-1sao.tgz
            - Name: jedit-4.4-noarch-1sao.tgz
            - Label: Slackware Installer
            - Release note: unchecked
            - Release notes for this file: /jedit/4.4/CHANGES.txt
            - Platform: <none>

10. Update the website in the following places:
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/download.html e. g. in jEdit with installed FTP plugin and update the website for the new release, means the filenames, filesizes and amount of pages in the User's Guides
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/jEdit-version.txt e. g. in jEdit with installed FTP plugin and update the versions in the file, which is needed by the LatestVersion Plugin
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/CHANGES44.txt e. g. in jEdit with installed FTP plugin and copy the contents of doc/CHANGES.txt to this file
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/index.php e. g. in jEdit with installed FTP plugin and update the version number and the Last Site Update date
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/devel.html e. g. in jEdit with installed FTP plugin and add a line for 4.4 in the Release Schedule

11. Update the plugin wizard
     - Go to http://plugins.jedit.org/wiz/release_add.php?package_id=24
     - Enter the Version "4.4"
     - Switch "Head of Branch" to "main"
     - Check the "Remove" checkbox for the jEdit dependency
     - Switch the "Low Version" of the JDK dependency to "1.6 [jdk-1.6]"
     - Click "Update Dependencies"
     - Click "Create Release"

12. Send an announcement eMail to the jEdit-announce list. The announcement should contain the contents of doc/CHANGES.txt for this release.
    You have to be set up to be able to post to jEdit-announce list.
    The mail should automatically get forwarded to the jedit-users list, but for that you have to be subscribed to that list too.

13. Ask Vampire <Vampire@jEdit.org> (Vampire0@#jEdit@chat.freenode.net) to update the topic of the IRC Channel

14. Delete the jedit-4-3-3 folder

15. Update the version number on the release branch
     - Add the following section to doc/CHANGES.txt

{{{ Version 4.3.4

Thanks to  for contributing to this release.

{{{ Bug Fixes


}}}
{{{ Miscellaneous


}}}
{{{ API Changes


}}}
{{{ Editing


}}}

}}}
     - Update the build number in org/gjt/sp/jedit/jEdit.java getBuild() method to
            return "04.03.99.04";
     - Update the version and build number in build.xml to
            <property name="jedit.version"
                      value="4.3.4" />
            <property name="jedit.build.number"
                      value="04.03.99.04" />
     - Submit your changes by doing
            svn commit -m "Updated the version number to 4.3.4."
       in the root source directory

:wrap=soft:maxLineLen=0:folding=indent:
