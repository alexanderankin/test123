==================================================
Packaging jEdit for release
==================================================

This document contains instructions on how to create and release jEdit for distribution, with all of the installers.

The analogous document for releasing plugins is in the jedit SVN repository under the name "pjo/doc/pjo.txt".

Release Workflow
================
Before you read this document, be sure to read first the README.SRC.txt, in the root source directory. It contains instructions on how to get and set up Apache Ant, what the targets mean, and what you need to build each kind of package.

Workflow
--------

1. Tag the sourcecode for release in the SVN repository by doing
        svn copy https://jedit.svn.sourceforge.net/svnroot/jedit/jEdit/branches/4.4.x https://jedit.svn.sourceforge.net/svnroot/jedit/jEdit/tags/jedit-4-4-pre2 -m "Tagging 4.4pre2 for release."
   with the correct version in the second URL and in the commit message

2. To be sure to work with the exact tagged source, check out the newly tagged source in a new directory by doing
        svn checkout https://jedit.svn.sourceforge.net/svnroot/jedit/jEdit/tags/jedit-4-4-pre2
   no matter where. You will find the source in a subfolder jedit-4-4-pre2 where you executed the command

3. Copy build.properties and jars/build.properties from your jEdit source directory to the newly created jedit-4-4-pre2 source directory. If you don't have the two, then create them. For the root directory you find a template called build.properties.sample there and for the jars/build.properties you find a template in build-support/build.properties. These are independent and have to be set up correctly. The one in the root directory is for jEdit itself, the one in jars is for the standard plugins.
   To give an example, in build.properties I customized the following properties:
    - wine.executable=wine
    - winepath.executable=winepath
    - innosetup.compiler.executable=/home/vampire/.wine/drive_c/Programme/Inno Setup 5/ISCC.exe
    - innosetup.via.wine=true
    - xsltproc.executable=xsltproc
    - docbook.xsl=/usr/share/xml/docbook/stylesheet/docbook-xsl
    - docbook.catalog=/usr/share/xml/docbook/schema/dtd/4.4/catalog.xml
    - fop.dir=/opt/fop-1.0
    - launch4j.dir=/opt/launch4j
   And in jars/build.properties I customized the following properties:
    - docbook.catalog=/usr/share/xml/docbook/schema/dtd/4.4/catalog.xml
    - docbook.xsl=/usr/share/xml/docbook/stylesheet/docbook-xsl
   You may not need to customize the same properties than me, e. g. if xsltproc is in your PATH environment variable, you may not need to customize xsltproc.executable.
   For further information about what you need to build the source, please read README.SRC.txt in the sources root directory.

4.1. Build the distribution files by doing
          ant dist
     in the jedit-4-4-pre2 directory
     In the newly created directory jedit-4-4-pre2/dist you find 8 files:
      - jedit4.4pre2manual-a4.pdf
      - jedit4.4pre2manual-letter.pdf
      - jedit4.4pre2source.tar.bz2
      - jedit4.4pre2install.jar
      - jedit-4.4pre2-noarch-1sao.tgz
      - jedit_4.4pre2_all.deb
      - jedit4.4pre2install.exe or jedit4.4pre2-dist-win-finish.tar.bz2
      - jedit4.4pre2install.dmg or jedit4.4pre2-dist-mac-finish.tar.bz2

4.2. If you have jedit4.4pre2-dist-win-finish.tar.bz2 in your jedit-4-4-pre2/dist folder you probably don't run a Windows box and don't have wine installed and set up, so please hand over this file to someone (e. g. <Björn "Vampire" Kautler> Vampire@jEdit.org) who does and ask him to unpack the file and run
          ant dist-win-finish
     and to hand over the resulting file jedit4.4pre2install.exe to you. The requirements for this are described in README.SRC.txt

4.3. If you have jedit4.4pre2-dist-mac-finish.tar.bz2 in your jedit-4-4-pre2/dist folder you probably don't run a Mac OS X box, so please hand over this file to someone (e. g. Björn "Vampire" Kautler <Vampire@jEdit.org>) who does and ask him to unpack the file and run
          ant dist-mac-finish
     and to hand over the resulting file jedit4.4pre2install.dmg to you. The requirements for this are described in README.SRC.txt

4.4. After you received the final distribution files jedit4.4pre2install.exe and jedit4.4pre2install.dmg you can delete jedit4.4pre2-dist-win-finish.tar.bz2 and jedit4.4pre2-dist-mac-finish.tar.bz2

5. - Connect to the SourceForge servers via one of the methods described in https://sourceforge.net/apps/trac/sourceforge/wiki/Release%20files%20for%20download
   - Add the sub-folder "4.4pre2" under "/home/frs/project/j/je/jedit/jedit-devel"
   - Upload the 8 final distribution files to the newly created folder on the SourceForge servers

6. - Go to https://sourceforge.net/projects/jedit/files/jedit-devel/4.4pre2/
   - Make the following settings for each file after clicking on the respective "i" icon
        - jedit_4.4pre2_all.deb
            - Download Button: Debian Installer
            - Default Download For: <none>
        - jedit4.4pre2source.tar.bz2
            - Download Button: Source Package
            - Default Download For: <none>
        - jedit4.4pre2install.jar
            - Download Button: Java based Installer
            - Default Download For: linux, bsd, solaris, others (if this is a stable release, <none> otherwise)
        - jedit4.4pre2manual-letter.pdf
            - Download Button: Manual in Letter Paper size
            - Default Download For: <none>
        - jedit4.4pre2manual-a4.pdf
            - Download Button: Manual in A4 Paper size
            - Default Download For: <none>
        - jedit4.4pre2install.dmg
            - Download Button: Mac OS X Installer
            - Default Download For: mac (if this is a stable release, <none> otherwise)
        - jedit4.4pre2install.exe
            - Download Button: Windows Installer
            - Default Download For: windows (if this is a stable release, <none> otherwise)
        - jedit-4.4pre2-noarch-1sao.tgz
            - Download Button: Slackware Installer
            - Default Download For: <none>

7. Update the website in the following places and also update this state in SVN:
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/download.html e. g. in jEdit with installed FTP plugin and update the website for the new release, means the filenames, filesizes and amount of pages in the User's Guides
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/jEdit-version.txt e. g. in jEdit with installed FTP plugin and update the versions in the file, which is needed by the LatestVersion Plugin
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/CHANGES44.txt e. g. in jEdit with installed FTP plugin and copy the contents of jedit-4-4-pre2/doc/CHANGES.txt to this file
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/index.php e. g. in jEdit with installed FTP plugin and update the version number and the Last Site Update date
    - Open sftp://<your sf username>,jedit@web.sourceforge.net/home/groups/j/je/jedit/htdocs/devel.html e. g. in jEdit with installed FTP plugin and add a line for 4.4pre2 in the Release Schedule

8. Update the plugin wizard
     - Go to http://plugins.jedit.org/wiz/release_add.php?package_id=24
     - Enter the Version "4.4pre2"
     - Switch "Head of Branch" to "devel"
     - Check the "Remove" checkbox for the jEdit dependency
     - Switch the "Low Version" of the JDK dependency to "1.6 [jdk-1.6]"
     - Click "Update Dependencies"
     - Click "Create Release"

9. Send an announcement eMail to the jEdit-announce list. The announcement should contain some announcing text and in the end the contents of jedit-4-4-pre2/doc/CHANGES.txt for this release.
    You have to be set up to be able to post to jEdit-announce list.
    The mail should automatically get forwarded to the jedit-users list, but for that you have to be subscribed to that list too.

10. Ask Vampire <Vampire@jEdit.org> (Vampire0@#jEdit@chat.freenode.net) to update the topic of the IRC Channel

11. Delete the jedit-4-4-pre2 folder

12. Update the version number on the release branch
     - Add the following section to doc/CHANGES.txt

{{{ Version 4.4pre3

Thanks to  for contributing to this release.

{{{ Bug Fixes


}}}
{{{ Miscellaneous


}}}
{{{ API Changes


}}}
{{{ Editing


}}}

}}}
     - Update the build number in org/gjt/sp/jedit/jEdit.java getBuild() method to
            return "04.04.03.00";
     - Update the version and build number in build.xml to
            <property name="jedit.version"
                      value="4.4pre3" />
            <property name="jedit.build.number"
                      value="04.04.03.00" />
     - Submit your changes by doing
            svn commit -m "Update the version number to 4.4pre3"
       in the root source directory

:wrap=soft:maxLineLen=0:folding=indent:
